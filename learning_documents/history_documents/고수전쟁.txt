고구려-수 전쟁은 598년, 612년, 613년, 614년에 고구려와 수나라 사이에 벌어진 전쟁이다.589년 수나라는 오랜 후한 삼국시대 이후 남북조시대를 거쳐 오랫동안 분열되었던 중국을 마침내 통일하였다. 수나라는 진을 멸망시키고, 장성 이북의 동, 서돌궐과 고구려에 압력을 가하기 시작했다. 수나라는 고구려에 사신을 보내 고구려의 영토를 염탐하였고, 그 후에도 몇 차례에 걸쳐 사신을 보내 지형을 알아보게 하였다. 마찬가지로 고구려 역시 수나라에 사신을 보내 동태를 살폈으며, 마침내 수 문제가 고구려를 공격하기 위해 비밀리에 군대를 양성하고 있다는 소식을 접하자, 이에 대비하여 방어 준비를 하였다. 수 문제는 이 사실을 듣고 글을 보내 이를 꾸짖었다. 598년 고구려의 영양왕은 말갈병 1만 명을 동원하여 요서(遼西))를 선제 공격하였고 수비하던 영주총관(營州總管) 위충이 겨우 방어하였다. 그러나 고구려의 선제공격은 수나라의 북방 요충지에 큰 타격을 입혔으며, 수 문제는 진노하여 제1차 고구려-수 전쟁을 일으키게 된다.수 문제는 그해 음력 6월에 한왕 양량과 왕세적을 대원수로 임명하고, 주라후에게 수군을 맡겨 수륙군 30만 명을 동원하여 수륙 병진책으로 고구려를 정벌하고자 하였다. 주라후의 수군은 동래에서 출발하여 평양으로 향하였으나 도중에 폭풍을 만나 대부분의 병력을 잃고 철수했다. 일각에서는 폭풍우 말고도 장산군도와 비사성 일대의 고구려 수군에 패했다고도 한다.[출처 필요] 육지로 진군한 양량의 군대도 요하에까지 진격하였으나 장마가 시작되고 전염병과 식량부족이 심화되어 결국 자진 철군하였다. 결국 실제로 전투는 벌어지지 않았으며 폭풍우와 전염병, 기아 등으로 인해 상당한 인명 손실만 입은 채 수나라 군대는 철병하였다. 가을 9월 수의 군사가 돌아가는데 죽은 자가 열에 여덟 아홉이었다. 그러나 수나라가 실제로 30만의 대군을 동원한 것에 충격을 받은 영양왕은 수나라에 사신을 보내어 사죄하고 표를 올리어 "요동분토의 신하 아무개"라고 일컬으니 수 문제는 이에 군사를 철회하고 처음과 같이 대우하였다그러나 일각에서는 위의 내용은 수나라 기록서인 수서에 있는 내용이며 과거 당나라의 역사가들에게 조작되었다고 주장하고있다. 즉 고구려에게 패배한뒤 중화의 역사에 치욕적인 패배를 숨기기위해 자연재해로 병력이 싸우기전에 몰살 되었다고 거짓으로 기록한 것이라고 주장한 것이다. 또한 신채호는 조선상고사를 인용해 수나라의 1차침입당시 30만대군은 고구려 장수 강이식에게 궤멸되다고 기록되어있다고 그 근거를 내새워 주장했다. 다만 조선상고사가 지금은 전해지지 않아서 그 명확한 내용을 파악하지 못 하고있다.604년 문제의 둘째 아들 양광이 수 양제로 등극하였다.607년 영양왕18년, 또한 수나라 수 양제는 북쪽 돌궐의 추장 가한 계민의 막부를 방문하였고 마침 계민의 막사에는 고구려 영양왕이 보낸 고구려 사신이 마침 계민에게 가 있었다. 계민이 우리 사신을 감히 숨길 수 없었다. 이 때 황문 시랑 배구가 수 양제에게 말했다."고구려는 원래 기자에게 봉하였던 땅이며, 한 나라와 진 나라가 모두 군현으로 만들었습니다. 그러나 지금은 신하의 나라로 행동하지 않고, 별도의 지역으로 되어 있기 때문에, 선제께서는 오랫 동안 그들을 정벌하려 하였습니다. 그리하여 양 량에게 군사를 주어 출동시켰으나, 그가 불초하여 공을 세우지 못한 것입니다. 이제는 폐하의 시대이니, 어찌 그들을 정벌하지 않고, 예절의 땅이 오랑캐의 소굴로 변하도록 방치할 것입니까? 오늘 고구려 사신은, 계민이 나라를 바쳐 왕화에 복종하는 것을 직접 보았으니, 그가 우리를 두려워하는 기회를 이용하여, 고구려가 우리에게 조공하도록 위협해두는 것이 좋겠습니다."수 양제는 이에 따라 고구려 사신에게 자기의 뜻을 전하도록 우홍에게 명령하였다. "계민은 성심으로 우리 중국을 받들었기 때문에 내가 직접 계민의 막부에 온 것이며, 명년에는 응당 탁군으로 갈 것이다. 너는 돌아가는 날로 너의 왕에게 다음과 같이 말하라. 마땅히 빠른 시간 내에 입조하되, 스스로 의심하거나 두려워하지 말라. 이리하면 내가 너의 왕을 보호하기를 계민과 같이 할 것이다. 그러나 만약 입조하지 않는다면, 계민을 거느리고 너의 땅을 토벌하리라."하였다.하지만 고구려 영양왕는 사신으로부터 이를 보고 받았으나 수 양제의 협박에 굴복하지 않았다. 따라서 고구려는 이제 수 양제가 장차 침공할 것을 대비하게 된다.수 양제는 돌궐의 계민가한에게 충성을 맹세 받은 뒤인 611년, 고구려 정벌을 결정했다. 이에 엄청난 양의 세금을 거둬야 했으며, 전선을 하루종일 건조하느라 열에 서너 명이 배에 구더기가 생기는 병에 걸렸다고 한다. 또한 온 나라의 말과 식량, 병기등의 물자를 탁군으로 옮겼다. 이에 곳곳에서 반란이 일어났는데, 양제는 이를 모두 진압하였다.611년 영양왕(?陽王) 22년 봄 2월 수제(隋帝)는 조서를 내려 토벌키로 하였다. 여름 4월 거가가 탁군(註 북경 남쪽)의 임삭궁에 당도하여 사방의 군사들이 탁군으로 모였다.612년 영양왕(?陽王) 23년(A.D 612년) 봄 정월 수 양제가 다음과 같은 조서를 내렸다."하찮은 고구려 무리들이 어리석고 불공하여 발해와 갈석 사이에 모여들고, 요(遼)와 예(濊)의 경계를 거듭 잠식하였다. 비록 한(漢), 위(魏) 때 주륙을 거듭 당하여 그들의 소굴이 잠시 엎어졌어도, 난리로 막힘이 많자 무리들이 다시 모여들어 지금은 지난 시대보다 더 많아졌다. 돌아보니 중국의 땅이 잘리어 오랑캐 땅이 되었다. 세월이 흐르면서 악이 쌓이고 가득차니, 하늘의 도는 음란한 자에게 재앙을 내리므로, 이미 망할 징조다. 도를 어지럽히고 덕을 무너뜨림이 헤아릴 수 없고, 악을 가리고 간사함을 품은 것이 하루를 세어도 다 헤아릴수 없을 정도다. 일찍이 조서를 내려보내 고하여도 조칙을 받아들인 적이 없고, 조근도 몸소 하지 않았다. 도망간 자들을 받아들임이 그치지 않고, 변방의 봉화자를 수고롭게 하며, 관문과 딱다기가 조용할 날이 없으니, 그로 인하여 백성들은 생업을 폐하게 되었다. 옛날에 정벌하면서 하늘의 그물에서 빼주어, 사로잡힌 자의 죽음을 늦추어주고, 후에 항복한 자도 죽이지 않았는데, 그 은혜를 생각지 않고 도리어 악을 쌓아, 거란 무리를 합쳐 바다의 수자리 군사들을 죽이고, 말갈의 습관을 익혀 요서를 침범하였다. 또 청구의 바깥에서 모두 직공을 닦고, 함께 정삭을 받드는데, 다시 왕래하는 길을 막아 보물을 빼앗고, 죄없는 사람들에게 잔학한 짓을 하였으니, 정성을 바치려는 사람들이 도리어 화를 당하였다. 수레를 탄 사신이 해동에 이르러, 번국의 경계를 지나려 해도 길을 막고 사신을 거절하여 임금을 섬길 마음이 없으니, 어떻게 신하의 예라고 할 수 있느냐? 이를 참는다면 무엇인들 용서 못하랴? 또 법령이 가혹하고 조세가 무거우며, 힘센 신하와 호족들이 국정을 틀어쥐고 붕당을 이루고, 뇌물을 주고받음이 마치 시장에서 물건을 사고파는 것과 같으니, 백성들의 억울함이 풀어지지 않는다. 해마다 거듭된 재앙과 흉년으로 기근이 들고, 병사들은 토벌로 쉬지 못하며, 부역의 기한이 없고, 군량 운반으로 힘이 다하여, 몸뚱아리는 구덩이나 골짜기에 구른다. 고통스러운 백성들은 누구를 따를 것인가? 경내의 백성들이 그 폐해를 견디지 못하여 슬프고 두려워도. 생명을 도모하기 위하여 고개를 숙이고 머리를 돌리니, 노인과 어린이도 혹독함에 탄식한다. 나는 풍속을 살피려 유주, 삭주에 왔는데, 조문하고 죄를 묻는 것을 두 번 걸음할 수 없어, 친히 6군을 거느리고 구벌을 펴서, 위급한 자를 구해주며, 하늘의 뜻에 따라 달아난 무리를 멸하여 선조의 가르침을 이을 것이다. 이제 마땅히 군율에 따라 행군하되 대오를 나누어 목적지로 향할 것이니, 우레같은 진군소리는 발해를 뒤덮게 하고, 부여를 지나 번개같이 휩쓸 것이다. 방패를 가지런히 하고 갑옷을 살피고, 군사들에게 경계하여 일러둔 후에 출행하며, 거듭 알리고 타일러서 필승을 기한 후에 싸우라" 라고 하였다.그리고 정월부터 수 양제는 직접 정벌군을 발진시켰다. 왼쪽 12군은 루방, 장잠, 해명, 개마, 건안, 남소, 요동, 현도, 부여, 조선, 옥저, 낙랑 등 길로 진군하고, 오른쪽 12군은 점선, 함자, 혼미, 임둔, 후성, 제해, 답돈, 숙신, 갈석, 동이, 대방, 양평 등 길로 진군하되 앞뒤 부대끼리 서로 연락이 끊어지지 않도록 하여 모두 고구려의 수도 평양에 집결하도록 하였다. 모두 1,133,800명이었는데 200만이라 일컬었으며, 군량을 나르는 자는 그 배가 되었다. 남쪽의 상건수 위에서 제사를 지내고, 임삭궁 남쪽에서 상제에 제사지내고, 계성 북쪽에서 마조에 제사지냈다. 제가 친히 절도를 제수하여 군대마다 상장과 아장을 각각 1명씩 두고, 기병은 40대로 하고, 각 대는 100명, 10대가 1단이 되게 하였으며, 보병은 80대로 하고 나누어 4단으로 하였으며, 단마다 각각 편장 1명을 두었다. 그 갑옷, 투구, 갓끈, 인장끈, 깃발은 단마다 색깔을 다르게 하였다. 하루 1군씩 40리 간격으로 영(營)을 이어 점진케 하니 40일만에 출발이 모두 끝났다. 머리와 꼬리가 계속되고 고각이 서로 들리며 깃발이 960리에 뻗쳤다. 어영 내에는 모두 12위, 3대, 5성, 9시가 있었는데, 내 외 전 후 좌 우 6군에 나누어 속하게 하고 그 뒤에 출발시키니 또 80리를 뻗쳤다.612년 3월15일, 수 양제가 직접 군사를 지휘하며 수나라의 대군은 요하에 이르렀고 수나라 대군이 모두 모여 물가에 이르러 큰 진을 이루었으나, 동쪽으로 진군(進軍)하는 수(隋) 나라 군사와 이를 방어하는 고구려 군사간에 첫 전투가 벌어졌고, 이곳에서 수(隋) 나라 군사와 고구려 군사간에 2달 동안에 걸쳐 치열한 전투가 벌어졌다. 고구려 군사가 강을 막고 지켰으므로 수나라 군사가 건너오지 못하였다. 수 양제가 공부상서 우문개에게 명하여 요하 서쪽 언덕에서 3개의 부교를 만들게 하였는데, 완성되자 끌어다 동쪽 언덕으로 갔으나 짧아서 한 길 남짓하게 언덕에 미치지 못하였다.매번 고구려 군사들이 크게 닥치자 수나라 군사로서 날래고 용감한 자들은 다투어 물가로 나아와 접전하였다. 고구려군이 높은 곳에 올라 공격하니, 수나라 군사들은 언덕에 오르지 못하고 죽은 자가 매우 많았다. 무술일(3월 19일), 수(隋)나라 군은 총공격을 하여 도하에 나섰으나 고구려군의 대반격에 크게 패하여 맥철장(麥鐵杖), 전사웅(錢士雄), 맹차(孟叉) 등 용맹한 장수들이 죽었다. 이에 군사를 거두어 다리를 끌고 서쪽 언덕으로 돌아갔다.수 양제는 크게 분노하여 다시 소부감 하조에게 명하여 다리를 잇게 하여 이틀만에 완성하였고, 이에 수나라 대군이 일제히 차례로 이어서 나아가 동쪽 언덕에서 크게 격전을 치뤘고, 이에 고구려 군사들이 크게 패하여 죽은 자가 만명을 헤아렸다.마침내 처음 요하에 도학한지 2달만에, 5월16일, 수나라 대군은 요하를 건너는데 성공하였다. 하지만 피해가 막심하여 원래 수나라의 대군은 여영군과 24군을 합쳐서 총 30군 1,133,800명이었다. 하지만 수나라군이 요하를 건넜을 때는 인원은 어영(御營) 6군을 빼고 24군 중 불과 9군 30만 5천명뿐이었다. 2달간의 요수 전투에서 정벌군은 무려 15군이 죽었다.요하를 건넜으나 다시 고구려군이 몰려와 요하 동안(東岸)에서 고구려 군사와 큰 전투를 치른 후 수제가 요수에 이르자 조서를 내려 천하에 사면을 베풀고, 형부상서 위문승 등에게 명하여 요수 동쪽의 백성들을 위무하게 하고, 10년 동안 조세를 면제해주고 군현을 두어 서로 통섭하게 하였다,5월 16일 수나라 군사들은 고구려 군사의 저항을 뚫고 요수를 건너 그날 요동성(遼東城)을 포위하였다. 요동성은 한나라 때의 양평성이다. 여름 5월 초 요동성 군사가 자주 나와 싸웠으나. 불리하게 되어 성문을 닫고 굳게 지키니 수제는 모든 군사에게 명령하여 공격케 하였다. 요동성이 함락되려 하자 성 안에 있던 사람들이 외치며 항복하기를 청하였으나 처음 여러 장수가 동으로 내려올 때 수제가 이르기를 "군사행동은 모두 아뢰고서 행하여라" 하였으므로 여러 장수가 그 칙지를 받들어 감히 응해 가지를 못하고 먼저 달려가 아뢰었다. 그에 대한 회보가 왔을 때에는 성 중의 방어 또한 갖추어져 항거하며 싸웠다. 이 같이 하기를 두세 차례 거듭하였으나 수제는 끝내 깨닫지 못하였고, 성은 항복하지 않았다.6월 수제가 요동성 남쪽에 행차하여 그 성지와 형세를 관찰한 뒤 여러 장수를 불러 꾸짖으며, "그대들이 힘을 다하지 아니해도 내가 그대들을 죽이지 못할 줄로 여기느냐" 하였다. 여러 장수가 다 벌벌 떨며 낯빛이 변하였다. 수제는 성 서쪽 수리에 머물러 육합성에 어거하였다.수제(隋帝)는 요수 전투에서 수나라 군사들이 대량으로 전사하므로서 종대대형(縱隊隊形)으로 진군이 어렵자 후군로(後軍路)와 보급로(補給路)가 차단(遮斷)당하지 않기 위하여 수제(隋帝)가 거느린 어영군은 요동성(遼東城)을 공격하고 9군 장수에게는 진군로 주변 요지(要地)에 있는 고구려 성을 점령하라고 명령을 내렸다. 이때부터 9군은 진군로 주변 요지에 있는 고구려 성 공격에 나섰다.우리 여러 성이 굳게 지키고 항복하지 아니하니 좌익위대장군 내호아가 강회의 수군을 거느리고 수백 리에 뻗쳐 병선으로 바다를 떠서 먼저 패수로부터 들어와 평양과 60리 거리의 지점에서 우리 군사와 만나 진격하여 크게 부쉈다. 호아가 승세를 타서 그 성을 육박하려 하자 부총관 주법상이 말리며 제군의 도착을 기다려 함께 진격하자고 청하였다. 호아는 듣지 아니라고 정병 수만명을 뽑아 곧장 성 밑으로 달려들었다. 우리 장수는 나곽 안의 빈 절 속에 복병해 놓고 군사를 내어 호아와 더불어 싸우다가 거짓 패하였다. 호아가 쫓아서 성 안에 들어와 군사를 풀어 사람을 사로잡고 물건을 약탈하느라 대오가 흩어지게 되자 복병이 터져 나오니 호아는 크게 패하여 겨우 몸만 빠져나가고 살아 남은 군사는 수천명에 불과하였다. 우리 군사는 병선이 있는 곳까지 쫓아갔으나 주법상이 진영을 단속하고 있으므로 물러났다. 호아는 군사를 끌고 돌아가 해포에 주둔하고 감히 다시 제군을 응접하지 못하였다.좌익위대장군 우문술은 부여도에서 나오고, 우익위대장군 우중문은 낙랑도에서 나오고, 좌효위대장군 형원항은 요동도에서 나오고, 우익위대장군 설세웅은 옥저도에서 나오고, 우둔위장군 신세웅은 현도도에서 나오고, 우어위장군 장근은 양평도에서 나오고, 우무후장군 조효재는 갈석도에서 나오고, 탁군태수 검교좌무위장군 최홍승은 수성도에서 나오고, 검교우어위호분낭장 위문승은 증지도에서 나와 모두 압록수의 서쪽에 모였다. 우문술 등의 군사는 노하, 회원 2진에서부터 사람과 말에게 모두 100일분의 군량을 주고, 또 갑옷, 무기와 아울러 의자, 융구, 화막을 나누어 주니, 사람마다 3석 이상이 되어 무거워 능히 운반할 수 없었다. 군중에 명령을 내려 “군량을 버리는 자는 목을 베겠다.”고 하였으므로, 사졸들이 모두 군막 밑에 구덩이를 파고 묻었다. 행군이 겨우 중로에 이르자 양식이 이미 떨어지게 되었다.왕은 대신 을지문덕을 시켜 그 진영에 나아가 거짓 항복케 하니 이것은 실상 그의 허실을 관찰하려 함이었는데 우중문이 먼저 받은 수제의 밀서에 "만약 왕이나 문덕이 오는 기회가 있거던 반드시 사로잡아야 한다" 하였으므로 문덕을 잡으려 하던 차 위무사 상서우승 유사룡이 굳이 말리어 중문은 못내 그 청을 들어 주었다. 문덕이 돌아가자 이내 후회하고 사람을 시켜 문덕을 속이되 "하고 싶은 말이 있으니 다시 오라" 하였으나 문덕은 돌아보지 아니하고 압록수를 건너가 버리니 우중문, 우문술 등은 문덕을 놓치고 마음이 편하지 못하였다. 우문술은 군량이 다 되어 가므로 돌아가려 했으나 우중문의 의견은 "정병으로써 문덕을 추격하면 성공할 수 있다"는 것이었다.우문술이 굳이 말리니 우중문은 노하여 "장군이 10만의 병력을 가지고서 능히 소적을 깨뜨리지 못한다면 무쓴 낯으로 제를 뵙겠소 나도 이 걸음이 반드시 성공할 수 없다는 것을 알고 있소 옛날의 명장이 능히 성공한 것은 결정권이 한사람에게 있었기 때문이었소 이렇듯 사람마다 각 마음을 갖고 있으니 어떻게 적을 이긴다 말이요" 하였다. 그때 수제가 우중문이 계획성이 있다 하여 제군으로 하여금 절도를 품해서 하라고 하였기 때문에 이 말이 나오게 되었다. 이로 말미암아 우문술 등은 하는 수 없이 응종하여 여러 장수와 더불어 강을 건너 을지문덕을 추격하였다. 문덕은 우문술의 군사가 굶주린 기색이 있는 것을 보고 지치게 하기 위하여 싸울 때마다 달아나기만 하니 이로 말미암아 우문술 등은 하루 사이에 일곱 번 싸워 다 승리하였다. 이미 손쉽게 승리한 것을 믿고 또 뭇 사람의 의논에 밀려 급기야 동으로 나아가 살수를 건너 평양성과 30리 거리에서 산을 의거하여 진영을 만들었다.을지문덕은 이때 우중문에게 사자를 보내 시를 한 편 보냈는데, 이 시가 바로 "여수장우중문시"이다. 또한 우문술에게도 사자를 보내어 영양왕이 황제에게 항복을 할 것이라는 거짓 정보를 흘렸다. 우문술은 우중문을 설득하여 요동으로 퇴각할 것을 지시했다. 문덕이 다시 사신을 보내어 거짓 항복서를 올리고 우문술에게 청하기를 "만약 군사를 철회한다면 마땅히 왕을 모시고 행재소에 가서 조회하겠습니다"라고 하였다. 우문술은 자기의 병졸이 지쳐서 다시 싸울 수 없음을 보았고 또 평양성이 험하고 굳어 졸지에 함락시키기 어려울 것으로 짐작하여 마침내 거짓 항복을 구실로 돌아가기로 하였다. 그리하여 방진을 만들어 행군하자 문덕이 사방으로 유격해 우문술 등은 싸우다 가고 가다 싸웠다.가을 7월 살수에 도착하여 군이 반쯤 건넜을 무렵 우리 군사가 뒤로부터 그 후군을 공격하니 신세웅이 전사하였다. 을지문덕은 퇴각하는 수나라 군에게 공격할 것을 명했다. 결국 수나라 군은 살수(薩水, 지금의 청천강으로 추정, 淸川江)에서 물을 만나 퇴각 속도가 더디게 되었다. 고구려 군은 이를 노려 총공격을 개시하였다. 이에 모든 군사가 무너져 걷잡을 수 없게 되었다. 남은 병사가 달아나 압록수에 당도하고 보니 하루 낮 하루 밤에 4백 50리를 걸은 폭이었다. 처음 9군이 요에 도착할 때는 무려 30만 5천명이었는데, 요동성에 되돌아 왔을 때는 겨우 2천 7백 명뿐이었고 수만으로 계산되는 기계와 물자도 거의 다 탕진되었다.수제는 크게 노하여 우문술 등을 쇠사슬에 묶어 가지고 돌아갔다. 수나라 군대가 요수를 건너자, 백제도 역시 국경에 군사를 엄히 배치하고 말로는 수나라를 돕는다고 하면서, 실은 양다리를 걸치었다. 수나라는 이번 군사행동으로 오직 요수의 서쪽에 우리의 무려라를 함락시켜 요동군과 통정진을 설치하였을 따름이었다.수 나라 개황 연간에 양제가 조서를 내려 고구려를 공격하자, 좌익위 대장군 우문술은 부여도로 나오고 우익위 대장군 우 중문은 낙랑도로 나와서 9군과 함께 압록강에 이르렀다. 문덕이 왕의 명을 받들고 적진으로 가서 항복하는 체하였으나, 이는 사실 그들의 허실을 보려는 것이었다. 술과 중문은 이 보다 앞서 황제의 비밀 교지를 받았었다. 이에는 고구려의 왕이나 문덕을 만나거든 체포하라고 쓰여 있었다. 이에 따라 중문 등은 문덕을 억류하려 하였는데, 위무사로 있던 상서 우승 유 사룡이 굳이 말리는 바람에 결국 문덕이 돌아가는 것을 허락하였다. 그 뒤에 이를 깊이 후회하여 사람을 보내 문덕을 속여서 말하기를 "재차 의논할 일이 있으니 다시 오라"고 하였으나, 문덕은 돌아보지도 않은 채 압록강을 건너왔다. 술과 중문은 문덕을 놓친 뒤에 마음 속으로 불안하게 생각하였다. 술은 군량이 떨어졌다 하여 돌아가려 하는데, 중문은 정예부대로 문덕을 추격하면 공을 이룰 수 있다고 주장하였다. 술이 이를 말렸다. 중문이 화를 내어 말했다. "장군이 10만의 병력을 가지고 와서 조그마한 적을 격파하지 못하고 무슨 낯으로 황제를 뵈옵겠는가?" 술 등은 마지못하여 그 말을 따라 압록강을 건너서 문덕을 추격하였다. 문덕은 수군에게 굶주린 기색이 있음을 보고, 그들을 피로하게 하기 위하여 싸울 때마다 매번 패배한 척하며 도주하였다. 이렇게 하여 술은 하룻 동안에 일곱 번을 싸워 모두 승리하였다. 그들은 갑작스러운 승리에 뱃심이 생기기도 하고, 또한 중의에 몰리기도 하여, 마침내 동쪽으로 나아가 살수를 건너 평양성 30리 밖에서 산을 등지고 진을 쳤다.을지문덕이 우중문에게 다음과 같은 시를 보냈다. "그대의 신기한 계책은 천문에 통달했고, 묘한 계략은 땅의 이치를 알았도다. 전투마다 이겨 공이 이미 높았으니, 만족한 줄 알았으면 돌아가는 것이 어떠하리." 우중문이 답서를 보내 효유하였다. 을지문덕이 또한 사자를 보내 항복을 가장하고 술에게 요청하였다. "만일 군사를 철수한다면 틀림없이 왕을 모시고 행재소로 가서 조견하겠다." 우문술은 군사들이 피곤하고 기운이 쇠진하여 더 이상 싸울 수 없을 뿐만 아니라, 평양성은 험하고 견고하여 갑자기 함락시키기는 어려울 것이라고 판단하여, 거짓 항복이라도 받은 상태에서 돌아가기로 결정하고 방어진을 만들며 행군하였다. 문덕이 군사를 출동시켜 사면으로 공격하니 술 등이 한편으로 싸우며 한편으로는 쫓겨 갔다. 그들이 살수에 이르러 군사가 절반쯤 강을 건너 갔을 때, 문덕이 군사를 몰아 그들의 후군을 맹공하여 우둔위장군 신 세웅을 죽였다. 이렇게 되자 모든 적군이 한꺼번에 허물어져 걷잡을 수가 없었다. 9군 장졸이 달려서 패주하였는데, 하루낮 하루밤 사이에 압록강에 이르니 그들은 4백 50리를 간 셈이다. 처음 요수를 건너 올 때 그들은 9군 30만 5천 명이었는데, 요동성에 돌아갔을 때는 다만 2천7백 명뿐이었다.제2차 고구려-수 전쟁이 끝난 지 4개월 후인 613년 3월, 수 양제는 다시 30만의 군사로 고구려를 침략함으로써 제3차 고구려-수 전쟁을 일으켰다. 613년 영양왕(?陽王) 24년 봄 정월 수 양제가 조서를 내려 천하의 군사를 탁군에 모으고, 백성들을 모집하여 효과를 만들고, 요동의 옛 성을 수리하여 군량을 저장하였다. 2월, 양광이 근신들에게 "고구려와 같이 하찮은 것들이 상국을 무시하고 있다. 오늘 날 우리의 국력이 바다물을 뽑아내고 산을 옮길 수 있거늘 하물며 이런 따위의 적이야 무엇이 문제이겠는가?"라고 말하고, 고구려를 다시 정벌할 것을 논의하였다. 이 때 좌광록 대부 곽 영이 간하여 말하기를 "오랑캐로서 예절을 지키지 못한 것은 신하로서의 일입니다. 천근 무게의 큰 활은 생쥐를 잡기 위하여 사용하지 않는 법이니, 어찌하여 직접 천자의 자리를 더럽혀 작은 도적을 대적하려 하십니까?"라고 하였으나, 양광은 이 말을 듣지 않았다.여름 4월 거가가 요하를 건넜다. 우문술과 양의신을 보내어 평양으로 향하게 하였다. 왕인공이 부여도로 나와 신성에 이르자, 우리 군사 수만명이 막아 싸웠다. 왕인공이 날랜 기병 1천명을 거느리고 우리 군사를 깨뜨렸으므로, 우리 군사는 성문을 닫고 굳게 지켰다.제가 여러 장수에게 명하여 요동성을 공격하였는데 편의에 따라 일을 처리하게 하였으므로, 비루(飛樓)·동차(?車)·운제(雲梯)·지도(地道)로 사면에서 함께 진격하여 밤낮으로 쉬지 않았다. 우리는 임기응변으로 막았으므로 20여일 동안 함락되지 않고, 적과 아군 중에 죽은 자가 매우 많았다. 충제의 장대의 길이가 15길이었는데, 심광이 그 꼭대기에 올라가 성을 내려다보며 우리 군사와 싸우는데 칼을 가지고 십수 명을 죽였다. 우리 군사는 다투어 그를 공격하여 그가 떨어지게 되었는데, 미처 땅에 떨어지기 전에 마침 장대에 줄이 늘어져 있어, 심광이 거기에 매달려 다시 올라갔다.제가 그것을 보고 장하게 여겨 즉시 조산대부에 임명하였다. 요동성이 오랫동안 함락되지 않자, 제가 베 주머니 백여만 개를 만들어 보내 그 속에 흙을 가득 넣어 쌓아 어량대도를 만들었는데, 넓이가 30보나 되고 높이가 성과 가지런하게 되어 전사들이 올라가 공격하였다. 또 바퀴 여덟 달린 누거를 만들었는데, 성보다 높게 하여 어량도를 끼고 성 안을 내려다 보고 쏘면서 기일을 정해 장차 공격하려고 하였으므로, 성 안은 매우 위급하였다.마침 양현감이 반역하였다는 글이 오니 황제가 크게 두려워하였으며, 또 고관의 자손들이 모두 양현감이 거처하는 곳에 있다는 것을 듣고 더욱 염려하였다. 병부시랑 곡사정이 본래 양현감과 친하였으므로 속으로 불안하여 우리에게 도망하여 왔다. 황제가 밤에 여러 장수를 몰래 불러 군사를 이끌고 돌아갔다. 군수품과 기계와 공격용 도구가 산처럼 쌓였고, 보루와 장막이 그대로여서 움직이지 않았으나, 무리의 마음이 떨며 두려워져 다시 부서를 나눌 새도 없이 여러 길로 흩어졌다. 양광은 밤에 여러 장수들을 조용히 불러 후퇴를 명하였다. 군수 기재와 공격용 도구들이 산더미처럼 쌓였고, 병영과 보루, 장막들도 자리에 둔 채 그대로 있었으나, 군사들의 마음은 흉흉하여 다시 부대를 정비하지 못하고, 여러 길로 흩어졌다.우리 군사는 즉시 이것을 깨달았으나 감히 나가지 못하고 다만 성 안에서 북치고 고함을 지를 뿐이었다. 다음날 오시가 되어 그제야 점차 밖으로 나갔으나, 수나라 군사가 속이는 것이 아닐까 하고 의심하였다. 이틀이 지난 뒤에야 비로소 수천명의 군사를 내어 뒤를 밟아 쫓았으나, 수나라 군사가 많은 것을 두려워하여 감히 압박하지 못하고, 항상 8, 90리의 거리를 두었다. 요수에 거의 이르러서 황제의 병영이 다 건넌 것을 알고는 그제야 감히 후군을 압박하였다. 우리 군사가 이를 즉시 알았으나, 감히 나가지는 못하고 성 안에서 북을 울리며 떠들고 있다가 이튿날 오시에야 조금씩 밖으로 나오기 시작하였다. 그러나 이 때도 오히려 수 나라 군사가 우리를 속이는 것으로 의심하였다. 이틀이 지나서야 수천 명의 군사를 출동하여 추적해 갔다. 그러나 수 나라 군사의 수가 많은 것을 두려워하여 가까이 접근하지 못하고, 일정하게 8·9십리의 거리를 두고 따라갔다. 거의 요수에 이르러서야 양제의 친병이 모두 건너간 것을 알고, 곧 그들의 후군을 공격하였다. 이 때에도 후군의 수가 수만 명이었는데, 우리 군사가 따라 가면서 끝까지 공격하여 대략 수천 명을 죽였다.수 양제는 양현감의 난은 진압했으나 국내의 혼란을 더욱 거세어졌다. 수나라는 도적이 들끓고, 지방에서는 통제력이 약해진 중앙 정부에 반기를 드는 세력이 늘어났으며 국가의 소집이나 징수에 불응하는 자가 많았다. 그럼에도 불구하고 수 양제는 다시 고구려 정벌을 시도하게 된다.614년 영양왕(?陽王) 25년 봄 2월 황제가 모든 신하들에게 조서를 내려 고구려를 정벌할 일을 의론하게 하였는데, 여러 날 동안 감히 말하는 자가 없었다. 조서를 내려 천하의 군사를 다시 징발하여 여러 길로 함께 진군하게 하였다. 한편 수나라군은 내호아가 이끄는 수군(水軍)을 통해 비사성(卑沙城)을 비사성을 여러 겹으로 포위하고 공격했으나 고구려군이 유일한 통로인 서문(西門)을 봉쇄하여 항전하자 함락시키지 못하고 있었다.가을 7월, 수 양제는 직접 회원진에 행차하였다. 이때 수나라는 이미 어지러워져서 징발된 군사들이 기일을 어기고 도달하지 못한 자가 많았으며, 고구려도 역시 지쳐 있었다. 내호아가 이끄는 수군은 우리 군사가 맞아 싸웠으나, 마침내 비사성을 함락시키고 이제 고구려의 수도 평양성으로 향하려고 하였다. 이미 고구려 또한 계속되는 전쟁에 피폐하고 지쳐있었다. 이에 고구려의 총사령관 건무는 이 소식을 듣고 완병술을 쓰려 했다. 우선 영양왕은 사신을 보내 항복을 청하고, 그에 따라 계략을 세워 고구려에 투항해 있던 곡사정을 수나라로 돌려 보냈다. 수 양제가 크게 기뻐하고 절부를 가진 사신을 보내 내호아를 소환하였다.8월에 수 양제가 회원진으로부터 수나라 군대를 돌이켜 철수를 시작하였다. 하지만 겨울 10월, 수 양제이 서경에 돌아가서 고구려 사신과 곡사정에 대한 일을 태묘에 고하고, 또한 고구려에 영양왕이 직접 수 나라 조정에 들어와 예방하라고 하였지만 고구려 영양왕이 끝내 듣지 않았다. 오히려 고구려는 조의 가운데 일인이라는 자가 있어 자원하여 따라가기를 청한 끝에 함께 표를 수 양제에게 바쳤다. 수 양제가 배에서 표를 손에 들고 읽는데 절반도 채 읽기 전에 갑자기 소매 속에서 작은 활을 꺼내 쏘아 그의 뇌를 맞혔다. 수 양제는 놀라 자빠지고 실신했다. 우상 양명은 서둘러 양광을 업게 하여 작은 배로 갈아타고 후퇴하여 회원진에 명을 내려 병력을 철수시키도록 하였다. 양광은 좌우에 말하여 가로대 '내가 천하의 주인이 되어 몸소 작은 나라를 쳐도 승리하지 못하니 이는 만세의 웃음거리가 아니겠는가?' 라고 했다. 양명 등은 얼굴색이 검게 변하여 대답 못하고 말았다. 이에 분노한 수 양제가 장수들에게 엄밀하게 대비할 것을 명하고, 다시 공격할 것을 기도하였으나 결국 실행에 옮기지 못하였다.이 전쟁으로 수나라는 많은 국력을 소진하였고, 이것이 지방에서의 반란과 중앙 세력의 약화로 이어져 멸망의 원인이 되었다. 고구려 또한 흐트러진 국내 사정을 바로잡기 위해 남쪽의 신라와 백제를 신경 쓸 겨를이 없었고, 수나라 이후 중국을 통일한 당나라에 호의적인 행동을 취하였다. 당나라 또한 피폐해진 국내를 바로 잡아야 했기에 고구려와 친선 관계를 유지하였다. 고구려가 당나라의 요청에 따라 경관(京觀)을 허문일은 이러한 상황 때문이었다. 그러나 중화 제국하의 질서를 원했던 당 태종이 황제에 즉위하면서 상황은 달라지게 되었다.당 태종은 진대덕(陳大德)을 고구려에 보내 첩보 활동을 명령하였다. 이처럼 당나라의 침략 의도가 분명해졌음에도 느슨한 태도를 보이는 영류왕의 태도와 그의 지나친 친당 정책에 반발한 연개소문(淵蓋蘇文)은 영류왕이 자신을 죽이려 한다는 사실을 눈치채자, 영류왕을 시해한 뒤 보장왕을 옹립하였다. 연개소문은 대당강경책을 주장해 고구려와 당 사이의 관계는 다시 험악해졌고, 결국 고구려-수 전쟁이 끝난 지 30여 년 만에 다시 고구려-당 전쟁이 일어나게 되었다.