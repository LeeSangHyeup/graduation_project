안시성 전투는 고구려-당 전쟁 중에 645년(보장왕 4)에 당나라 태종이 지휘하는 군대가 대규모로 고구려를 침공하여 3개월가량 안시성을 포위, 공격했으나 끈질긴 항전으로 이를 물리치고 고구려가 승리한 싸움이다.644년 6월, 호시탐탐 기회를 노리던 당태종은 마침내 고구려의 침략을 명령한 후 11월 수륙 양면으로 약 50만 명에 달하는 대규모 원정군을 편성해 공격을 시작했다. 이때 당군은 각종 공성용(攻城用) 기구를 총동원했다. 당 태종은 다음해 2월에 낙양(洛陽)을 출발하여 직접 원정길에 올랐다. 또한 돌궐과 거란으로 구성된 이민족의 군대도 다수 동원되었으며 대다수의 군대가 예전 수나라 때의 원정군과는 질적으로 다른 정예병으로 구성되어 있었다. 이세적이 이끄는 선발대와 당태종 이세민이 직접 지휘하는 친정군, 그리고 장량이 지휘하는 수군으로 크게 3갈래로 침입해 왔으며 당군은 효과적인 기만전술과 기습으로 고구려의 현도성,개모성,비사성,요동성, 백암성 등이 차례로 함락되었다. 당시 요동방면에서는 가장 북쪽의 신성, 그리고 남쪽의 안시성, 건안성 들이 격렬히 저항하고 있었고, 당태종의 당의 대군은 요동성에서 집결 한 후, 안시성 방면으로 진격하게 된다. 당 태종은 다음해 2월에 뤄양(洛陽)을 출발하여 직접 원정길에 올랐다. 요동에 진입한 이세적(李世勣)의 군대는 개모성(蓋牟城)을 함락시키고, 장량(張亮)의 수군은 비사성(卑沙城)을 함락시켰다. 태종이 직접 독려하는 가운데 645년 5월에는 요동성까지 함락시킨 뒤 백암성(白巖城)을 공격했다.백암성이 6월에 함락되자 태종은 "안시성이 연개소문의 정변 때도 안시성 성주가 복종하지 않아 공격을 받았으나, 항복시키지 못했다고 들었다"라고 말하며 우회할 것을 주장했다. 그러나 보급로가 차단될 것을 염려한 이세적의 건의를 받아들여 안시성을 공격하기 시작했다. 고구려의 중앙정부에서는 고정의(高正義)·고연수(高延壽)·고혜진(高惠眞)의 지휘 아래 말갈군을 포함하여 15만 명의 군사를 내어 안시성 구원을 위해 출동시켰으나 초전에 당군의 유인 작전에 말려들어 패배, 고연수,고혜진이 항복했다.8월 2일(음력 7월 5일), 당나라군은 안시성(安市城) 동쪽 고개로 이동하였고 부근의 작은 성 후황성과 은성을 공격하여 함락시켰다. 고구려의 대군은 아직 건재하고 있었고 고구려군과의 전투 중 많은 희생자를 내게 된다. 당측의 사서에는 8월 10일(음력 7월 13일) 수많은 전사자의 시체에 표식을 하고 이후 일부군대가 퇴각할 때 같이 귀환하도록 하였다.9월 6일(음력 8월 10일) 드디어 당태종의 당의 대군은 안시성 공격을 시작한다. 이에 안시성 사람들이 당군의 깃발과 일산을 바라보고, 즉시 성에 올라 북을 두드리고 함성을 지르니 당태종이 크게 분노하였다. 이세적은 성이 함락되는 날 안시성의 남자를 모두 구덩이에 묻어 버릴 것을 황제에게 요청하였다. 안시성 사람들은 이 말을 듣고 더욱 굳게 수비하였다. 당 나라 군사가 오랫동안 공격하였으나 안시성을 함락시킬 수 없었다. 무엇보다 요동성과 개모성 함락에 큰 활약을 보인 당군의 공성 신무기였던 각종 포차들의 활약이 현저히 떨어졌다. 안시성은 평지의 요동성과 달리 산에 의지한 산성이다. 따라서 중국의 중원이나 요동성 같은 평지에서 큰 효과를 발휘했던 신무기의 효과들이 크게 반감되었다.안시성 공략이 어려워지자, 이때 고연수·고혜진 등이 태종에게 "저희들이 이미 대국에 몸을 맡겼으니, 정성을 바치지 않을 수 없습니다. 천자께서 빨리 큰 공을 이루어 우리가 처자와 만나게 하여 주기를 원합니다. 안시성 사람들은 그의 가족들을 생각하여 자진하여 싸우고 있기 때문에 빨리 함락시키기는 쉽지 않습니다. 저희들은 고구려의 10여 만 명의 병력을 가지고 있었음에도 불구하고, 황제의 깃발을 보는 것만으로 사기가 꺾여 허물어졌으며, 백성들의 간담이 서늘하였습니다. 오골성의 욕살은 늙어서 수비가 견실할 수 없으니, 군사를 옮겨 그곳을 공격한다면, 아침에 도착하면 저녁에는 승리할 것이며, 도중에 있는 여타의 작은 성들은 위풍만 보고도 반드시 허물어질 것입니다. 이러한 연후에 그곳의 자재와 군량을 거두어 북을 울리며 전진하면, 그들은 틀림없이 평양을 지켜내지 못할 것입니다."라고 하여 안시성 대신 오골성을 직접 공격할 것을 주청하였다. 여러 신하들이 또 말했다. "장량의 군사가 사성에 있으니, 그를 부르면 이틀이면 올 수 있습니다. 고구려가 두려워 하고 있는 틈을 이용하여, 장 량의 군사와 힘을 합하여 오골성을 함락시키고, 압록강을 건너 곧바로 평양을 빼앗는 것이 이번 일에 달렸습니다."당태종 이세민이 이 말을 따르려 하자 장손 무기가 홀로 나서서 다음과 같이 말했다. "천자의 원정은 보통 장수들의 정벌과는 다르다. 따라서 모험을 하면서 요행을 바랄 수는 없다. 지금 건안성과 신성의 무리가 아직도 10만이나 되는데, 우리가 만약 오골성으로 간다면, 고구려 군사들이 반드시 우리의 뒤를 추격할 것이다. 그러므로 먼저 안시성을 점령하고 건안성을 취한 후에 군사를 먼 곳으로 진군시키는 것이 옳다. 이것이 만전의 계책이다." 장손 무기의 말을 듣고 이세민은 곧 앞서의 계획을 중지하였다.
당태종은 안시성이 만만치 않음을 깨닫고 건안성 패잔병(장량의 6만의 수군)과 이도종, 장검의 군사등을 모두 모았다. 당태종 친정군과 6도행군 56만도 안시성으로 집결했다. 어느 날 태종은 성 안에서 들리는 닭과 돼지의 소리를 듣고 이세적에게 밤 중 안시성에서의 기습 공격에 대비할 것을 명하였다. 이날 밤, 안시성의 군사 수백 명이 성에서 줄을 타고 내려왔다. 태종은 이 말을 듣고 직접 성 밑에 와서 군사를 소집하여 재빨리 공격하였다. 안시성 군사 중에 사망자가 수십 명이나 되었고, 나머지는 도주하였다.그럼에도 안시성의 저항이 완강하자, 당군은 강하왕 이도종의 건의로 성의 동남 쪽에 토산을 쌓아 점점 성으로 접근해왔다. 성 안에서도 역시 성벽을 더욱 높게 쌓아 굳게 방어하였다. 양군은 하루에도 6, 7회씩 교전하였다. 당나라 군사의 충거와 포석이 누대와 성위의 작은 담을 허물었으나, 성 안에서는 그 때마다 목책을 세워 부서진 곳을 막았다.당나라는 60일 동안 총인원 50만 명을 동원하여 토산(土山)을 쌓았다. 토산이 완성되자, 이 토산의 꼭대기가 성보다 높게 되어 밖에서는 성 안을 내려볼 수 있었다. 이도종이 과의(果毅)부복애(傅伏愛)를 시켜 500명의 군사를 거느리고 산정에 주둔하여 적을 대비하게 하였다. 그러던 중에 산이 폭우로 허물어지면서 성을 덮치는 바람에 성의 일부가 무너졌다. 토산이 무너지자 안시성의 군사 수백 명이 성이 허물어진 곳으로 나가 싸워서 마침내 토산을 탈취하여 그곳에 참호를 파고 수비하였다. 태종은 토산을 빼앗기자 진노하여 부복애의 목을 베어 조리를 돌리고, 장수들에게 명령하여 성을 공격하게 하였다. 고구려측 군사 1만, 당군 3만이 전사하였다.결국 이길 수 없자, 도종이 맨발로 황제의 깃발 아래 가서 죄를 청했다. 이에 태종은 이도종에게라고 하였다.이날 토산 전투, 그리고 그 뒤 펼쳐진 토산 쟁탈전에서 당군 수만명이 목숨을 잃었고 고구려의 피해도 만만치 않았다. 또 3일간의 토산 쟁탈전 이전의 석달간 공방전에서 당군은 하루 2~3천의 피해를 입었다고 전해진다. 하루 피해인원을 평균 2500이라 쳐도 무려 20만이 넘는 사상자를 낸 것이었다. 고구려측도 안시성 군사 중 요서전에 따라갈 수 있을만한 인원이 3만이 채 안되었다고 한다. 전투는 그만큼 치열했는데, 당 태종이 안시성주 양만춘의 화살에 맞아 한쪽 눈을 잃었다는 야설도 있다. 당의 공격을 막아낸 안시성의 성주에 대하여 역사서에는 어떠한 자료도 없이 그냥 "안시성의 성주"로만 기록되고 있었다. 특히 《삼국사기》의 저자 김부식은 안시성주에 대해 크게 칭송하면서 이름이 남아있지 않은 것을 한탄하였다. 그러나 조선 시대 송준길(宋浚吉)의 《동춘당선생별집》과 박지원의 《열하일기》에는 안시성 성주의 이름을 "양만춘(梁萬春)" 혹은 "양만춘(楊萬春)"이라고 밝히고 있다.안시성 전투는 1차 고구려-당 전쟁중의 가장 중요한 전투 중에 하나였지만 안시성의 성주에 대해서는 역사서에는 어떠한 자료도 없이 그냥 "안시성의 성주"(安市城主)로만 기록되고 있다. 하지만 후세에 송준길(宋浚吉)의 《동춘당선생별집》(同春堂先生別集)과 박지원의 《열하일기》에는 안시성 성주의 이름을 "양만춘"(梁萬春) 혹은 "양만춘"(楊萬春)으로 밝히고 있다. 하지만 1000년이 지난 후인 조선 후기에 이름이 등장하는 이유로 과연 용감하게 안시성을 지켜내었던 안시성 성주의 이름이 양만춘인가에 대해 사학자들은 의문을 갖고 있다.