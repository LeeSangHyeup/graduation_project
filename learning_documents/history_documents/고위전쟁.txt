고구려-위 전쟁은 242년, 244년, 245년, 259년에 고구려와 위사이에 벌어진 전쟁이다.초기 고구려는 부여나 한군현(漢郡縣)과 투쟁하면서 성장하였고 비옥한 영토를 차지하고자 정복 활동을 적극으로 벌이는 과정에서 기원전 128년 예(濊)의 족장 남려가 한(漢)과 함께 창해군(滄海郡)을 만들어 고구려를 압박했지만, 기원전 126년 끝내 축출했으며, 기원전 75년 한의 속현인 현도군을 압록강 유역에서 축출하는 등 부족 연맹체를 굳히고 1세기 초에 이미 왕호를 제정한 이후 고대국가로서 본격으로 건국하게 된 고구려는 발판을 탄탄히 하고 북옥저와 졸본과 국내성 주변 지역을 흡수했다.고구려가 이렇게 성장하자 위협하는 제국이 늘었다. 농안을 거점으로 성장한 부여는 기원전 6년과 13년에 침공하고 복속을 요구했으나 오히려 세력을 키운 고구려가 21년, 부여 정벌을 감행하여 부여왕을 대소왕를 죽이고 귀환한 이후 부여는 고구려를 섣불리 침공하지 않았다. 부여를 격퇴한 고구려는 영토를 더욱 확장하자 28년 한이 침공했지만 고구려는 국내성에서 농성하면서 방어했고32년 낙랑군도 정복하는 등 만주와 북부 한반도에서 위세를 떨쳤다.53년에 즉위한 태조대왕(太祖大王) 때에 이르러 고구려의 5부족은 중앙 행정 단위인 5부로 통합됐다. 옥저(沃沮)를 복속시키는 등 고대국가의 모습을 갖추기 시작했고 그는 주위의 여러 부족을 정복해 동으로 옥저와 동예(東濊)를 공격하고 남으로는 살수(薩水)[1]에 미치고 북으로는 부여(夫餘)를 압박하고 서로는 한의 요동군과 현도군과 대립해 1세기에서 2세기에 걸쳐 고구려는 고대 정복국가로서 위세를 떨친 일변, 후한(後漢) 말기에 중원이 3국으로 분열되어 혼란했던 시기였고 요동 일대는 공손씨(公孫氏)의 독립 세력권에 있었다. 고구려는 서진하려면 서의 요동의 공손씨와의 필연으로 충돌할 수 밖에 없었고 요동의 공손씨 세력에게는 중원의 위(魏) 외에도 동의 고구려는 위협스러운 세력이었다.당시 요동의 공손연은 반 독립 세력을 구축했지만 아버지 공손강이 위 조조에게 복종했듯이 위에 계속 복종했는데 233년 동천왕 7년,요동의 공손연(公孫淵)이 사자를 파견해 손권에게 번국(蕃國)으로서 빙문(聘問)했다. 동오의 황제 손권이 공손연에게 연 왕 작위와 구석(九錫)의 지위를 내려 포섭을 시도하고자 병사 1만 명과 금은보화를 공손연에게 보내고 배를 태워 요동으로 보냈다. 장소가 아직 공손연이 신뢰할 만한 인물인지 알 수 없다면서 반대했지만, 손권은 이 말을 듣지 않고 사자를 파견했다. 과연 공손연은 손권의 사신을 참수해 그 수급을 조위에 보내고 동오군과 재물을 탈취했으며 위 황제 조예에게서 낙랑공(樂郞公) 작위를 받은 일변, 위 황제 조예는 금번에는 요동 공손씨 세력의 동에 있는 고구려를 포섭하고자 234년 동천왕 8년, 고구려에 사신을 보내자 위와 고구려는 화친하고 외교관계를 수립했다.236년 동천왕 10년 봄 2월에는 당시 위(魏)와 대치했던 동오의 황제 손권이 금번에는 고구려를 포섭하고자 사신 호위를 보내 화친을 청했지만, 고구려 동천왕은 그 사신을 억류했다가 가을 7월에 그 사람을 괵수해 위(魏) 황제 조예에게 보냈다. 당시 중원은 위(魏)와 동오가 서로 대치했으므로 먼저 화친했던 위(魏)와 의리를 지킨다. 이때까지 국제정세는 고구려는 위(魏)와 화친하고 요동의 공손씨와 대치했고 요동의 공손씨도 고구려와 대치앴으며 위(魏)에는 복종했다.그러나 237년 동천왕 11년, 요동의 공손연은 요동의 세력에 자신감을 느끼며 중원에서 원격해서 통제가 어려운 지리상 이점에 자만해 조위에 대항하자 가범(賈範), 윤직(倫直)이 위에 대항하려는 공손연을 함께 말렸으나 살해된 일변, 위(魏)의 황제 조예는 유주자사 관구검에게 오환족과 선비족을 거느리고 공손연을 공격하게 했으나 공손연의 저항으로 요하를 넘지 못한 채 요수(遼隧)에서 발이 묶였고 장마철이 돼 요하가 범람하자 요동에서 우북평으로 한 철수는 수백 년 후 수 문제가 고구려를 침공했으나 장마철이 돼 요하가 범람해 회군했던 제1차 고구려-수 전쟁 상황과 같았다.이렇게 위와 요동의 공손씨가 반목하기 시작하자 고구려 동천왕은 위에 사신을 파견해 위(魏)의 경초로 개정된 연호를 축하하며 위와 더 돈독히 관계했다.익년 238년 고구려 동천왕 12년, 위(魏)경초 2년(238년), 요동의 공손연은 연호를 소한(素漢)으로 하고 연왕(燕王)을 자칭해 위(魏)에 정면으로 대항할 뜻을 결국 분명히 표현하자 조위 황제 조예는 위에 인질로 잡혀있던 공손연의 형, 공손황(公孫煌)을 죽이고 사마의(司馬懿)에게 토벌군 4만 명을 이끌고 요동 정벌하라고 출전시켰다.사마의는 요동으로 진군하면서 우북평으로 물러나 주둔하던 관구검의 군대를 휘하에 편입하고 선비족[2]의 군대도 요동 정벌에 참전시킨 일변, 동맹 관계인 고구려[3]에 사자를 파견해 요동의 공손연을 양쪽에서 협공하도록 원병을 요청하자 고구려 동천왕은 고구려의 주부와 대가들을 보내어 군사 1천 명을 거느리고 요동 공손연을 협공하게 한 일변, 공손연은 비연(卑衍)을 대장으로 삼아 양조(楊祚)과 함께 요수에 주둔시켜 20여 리에 걸쳐 구덩이와 책등을 둘러쳐 위군의 내습에 방비한 일변, 요동군은 요수에 의지해 위(魏)군에 저항하자 사마의의 위군은 남으로 도강하려는 체하고 실은 북으로 도강해 연의 도읍 양평 (이후 고구려 시대의 요동성)으로 곧바로 향했다. 사마의의 이런 요동 방어군의 허를 찌르는 교묘한 우회 전략도 수백 년 후 고구려를 침략한 당 태종 이세민 휘하 당군도 이런 사마의의 허허실실 전략을 차용해 당군의 도하가 예상되던 회원진이 아닌 북으로 크게 우회해서 통정진을 건너서 현도성과 신성으로 침공한 고구려-당 전쟁 시 재연된다.이에 대경란 비연(卑衍)은 양조(楊祚)를 선봉으로 삼아 사마의의 위군을 황급히 추격했만, 사마의는 이런 추격을 예상하고 복병을 두었고 요동군은하후패(夏侯霸)와 하후위(夏侯威)의 복병에게 당해 연패했고 위 대군이 연의 도읍 양평에 인접하는 위기에 닥치자 총공격했으나 요동군은 위 장수 호준(胡遵)에게 대격파당하고 비연(卑衍)은 전사했다.사마의 휘하 위군은 양평성[4]을 결국 포위했다. 당시 호우(豪雨)가 쏟아져 진영이 침수될는지 염려됐으나 버티고 우과천청(雨過天晴)하자 포위망을 완성하고서 맹공격해 결국 함성(陷城)하고 사마의(司馬懿) 휘하 위군에 패퇴해 공손연과 그 사람의 아들인 공손수(公孫修)와 도주하다가 위군에 잡혀 목이 잘렸다. 15세 이상 남자 7천 명을 죽여 경관을 세우고 연(燕)의 관원과 장수를 위시해 2천여 명을 주륙(誅戮)했고 사마의(司馬懿)는 예전에 충언했다가 살해된 가범과 윤직의 후손에게 관직을 내렸다.수백 년 후에 벌어지는고구려-당 전쟁 때 요동성 함락과 차이가 있다면, 고구려는 요동성이 함락됐어도 후방에 도읍인 평양성을 위시해 국내성, 북방의 부여성을 비롯해 풍부한 예비 전력 보유와 추가 병력 지원이 가능한 더 대국이라서 더 장기 전쟁이 가능했지만, 요동의 공손연에게는 요동성 후방에는 숙적인 고구려가 노렸기에 돌아갈 곳이 없는 영토와 인구 규모에서 근본으로 이미 큰 차이가 있었다는 점에서 제1차 고구려-당 전쟁보다 금방 종전됐다.이렇게 요동의 공손씨는 멸망해 위(魏)에 완벽히 편입됐다. 이것은 고구려 처지에서는 늘 고구려의 위협이었던 요동의 공손씨 세력이 멸망했지만 이로 말미암아 고구려와 위(魏) 간에 완충지가 사라져 이제 고구려는 중원의 여러 왕조와 본격으로 직접 대치해 필연으로 충돌하는 상황에 직면했다.242년 동천왕 16년, 고구려 동천왕은 요동의 공손씨의 멸망하자 이제 서측의 요동으로 진출하고자 위(魏)의 서안평(西安平)을 공격해 격파하고 점령한 때 동천왕의 신하 득래는, 위(魏)를 침략하고 맞서는 것을 수차례 간했으나 동천왕은 그 말을 좇지 않았다. 득래는 탄식하면서 "머지 않아 이 땅이 쑥대밭이 되는 참혹상(慘酷相)을 목도하리라."라고 말하면서 음식을 먹지 않고 아사했다.이제 고구려와 위(魏)는 충돌이 불가피했다. 244년, 위(魏)에서는 이 지역에 있던 유주자사 관구검에게 오환족[5]과 선비족[6]을 포함해 고구려를 결국 침공하게 하자 보병과 기병 2만 명을 거느리고 위(魏)군과 비류수 전투를 벌여 위(魏)군을 대파하고서 3천여 명을 참수하고 군사를 이끌고 위(魏)군과 양맥 골짜기에서 재전투해[7] 역시 위(魏)군을 격파하고 3천여 명을 죽이거나 생포한 동천왕이 제장에게 "위(魏)의 대병력이 오히려 우리 고구려의 적은 군사만도 못하다. 관구검이란 사람은 위 의 명장이지만, 오늘날에는 그 사람의 목숨이 내 손에 달려 있구나!"라고 말하면서 자만했다.관구검의 고구려침공은 저번 사마의와 관구검의 요동 공손연 정벌 때와 달랐다. 당시 요동 정벌 때는 요하라는 천혜의 장애물이 있어 방어에 용이했지만 일단 도하하면 요동의 도읍 양평[8]까지는 쭉 평지였으며 반대편에는 고구려가 있어서 완벽한 포위가 가능했지만, 고구려는 당시 중화관으로는 세상의 끝이라는 요동보다 더 동측에 있었고 고구려 도읍 환도성을 포함한 대부분은 평지가 아닌 험준한 산세 속에 있어서 주로 평지에서 기동전과 공성전에 익숙했던 위(魏)군에게는 요동 공손연 정벌 때와 판이(判異)한 환경에서 원정했다.관구검의 위(魏)군이 재공격하자 동천왕은 고구려 철기 5천 기를 거느리고 또다시 선봉에서 돌격했지만, 관구검이 방진을 치고 유인해 금번에는 고구려군이 포위됐다. 관구검의 위(魏)군이 고구려군을 포위해 결사로 공격하자 고구려군은 2만 명 중 1만8천여 명이 죽은 탓에 주력군은 소멸했고 동천왕은 기병 1천여 기를 대동하고 가까스로 탈출해 압록강 부근으로 도주했지만, 비류수전투와 양맥전투에서 대패한 관구검 휘하 위군도 전력을 크게 상실했으므로 일단 철수한다.245년, 동천왕이 이끄는 고구려의 주력군을 격파한 관구검은 이제 고구려의 도읍 환도성[9]을 다시 정조준한다. 고구려의 대군이 궤멸돼 전력이 허술하다고 판단했지만, 험한 산세의 압록강 중류 지역에 있는 고구려의 도읍 환도성은 도달하기까지 험한 산세로 어려웠고 천연한 요새화 탓에 함락하기가 어렵지만, 관구검의 위군은 후일 위 등애가 험한 산세를 뚫고 촉을 함락했듯이 험한 산로를 행군해 환도성을 기습해서 함락한다. 사서에는 관구검 부대는 마제(馬蹄)에 천을 싸매고 위험을 무릎쓰면서 기습했다고 기록됐다.[출처 필요] 즉 주력군이 궤멸해 방어하는 전력이 약해진 고구려지만 도읍 환도성은 천혜의 요새로서 함락하기 아려운 실정을 감안해 기습해 환도성을 함락한 관구검 휘하 위군은 백성을 함부로 비참하고 끔찍하게 마구 죽였다. 이 전쟁 시에 위 장수가 숙신 남측 경계에 이르러 돌에 전공을 새겨 기념하고 환도산에 이르러 불내성에 기념비를 새겼다. [[괄지지]에는 "불내성은 즉 국내성이다. 그 성은 돌을 쌓아 만들었다"라고 기록됐다. 이는 환도산과 국내성이 서로 접해 있기 때문이다. 양서에는 "사마의가 공손연을 치자 고구려왕이 장수를 보내 서안평을 습격했므로, 관구검이 와서 침노했다"라고 기록된 일변, 관구검은 예전 사마의가 공손연을 토벌한 후 공손연에게 충언해서 죽었던 가범과 윤직의 후손에게 관직을 내렸듯이 고구려의 득래가 동천왕에게 충언으로 간한 사실을 듣고 군사들로 하여금 그 사람의 무덤을 헐지 말며 무덤에서 자라는 나무를 베지 못하게 하고 그 사람의 처자들을 찾아 모두 석방하라고 명령했고 장군 왕기를 보내 동천왕을 재추격했다. 동천왕은 남옥저로 도주하다가 죽령에 이르렀다. 군사들은 흩어져 거의 모두 없어졌지만, 동부의 밀우가 혼자 왕의 옆에 있다가 동천왕에게 말했다. "지금 추격해 오는 적병이 지근거리(至近距離)에 있으므로, 불가피한 형세가 됐습니다. 제가 죽기를 각오하고 있는 힘을 다해 적군을 방어하면, 왕께서는 피할 수 있을 듯합니다". 그 사람은 드디어 결사대를 모아 그 사람들과 적에게 함께 달려들어 모든 힘을 다해 싸웠다. 왕은 간도(間道)로 가다가 간곡(澗谷)에 의지해 흩어진 군사를 모아 호위하게 하였다. 왕은 "만약 밀우를 찾아 오는 사람이 있으면 후히 수상(授賞)하겠다." 라고 하자, 하부 유옥구가 앞으로 나와서 "제가 해보겠습니다."라고 말하고 즉시 전장으로 가서 땅에 쓰러진 밀우를 발견하고 등에 업어 왔다. 왕은 자신의 다리위에 밀우를 눕혔다. 밀우는 한참이 지나서야 소생했다. 왕은 간도를 재전전해 남옥저에 도달했으나 위군은 추격을 멈추지 않았다. 왕은 적절한 계책도 없고 형세가 어려워 어찌할 바를 몰랐다. 동부 사람 유유가 나와 말했다. "형세가 위급하다고 해서 헛되이 죽을 수는 없습니다. 저에게 어리석은 계책이 있습니다. 제가 음식을 가지고 가서 위군을 위로하다가, 기회를 보아 적장을 찔러 죽이고자 합니다. 만약 제 계책대로 되면, 그때 왕께서 적을 맹공해 승리할 수 있을 듯합니다." 동천왕이 이를 허락하자 유유가 위 군중에 들어가서 항복을 가장하고 말했다. "우리 임금이 대국에 죄짓고 해변으로 도망했으나 이제 왕은 의지할 곳이 없으므로, 장차 귀국의 진영에 항복해 귀국의 법관에게 죽음을 맡기려 하는데 저를 먼저 보내 변변치 못한 음식으로 군사들을 대접하게 했습니다." 위 장수 왕반이 이 말을 듣고 그 사람에게 수항(受降)하려고 하는 때 유유가 나아가 식기에 감추어서 가져갔던 칼을 뽑아 위 장수의 가슴을 찌르고서 그 사람과 함께 죽었다. 위군은 즉시 혼란에 빠졌다. 왕은 군사를 세 길로 나누어 급습했다. 위군은 혼란한 와중에 전열을 가다듬지 못하고 낙랑에서 결국 퇴각했다. 왕은 귀국해 공적을 평가했다. 밀우와 유유는 1등이었다. 밀우에게는 거곡과 청목곡을 주고 옥구에게는 압록과 두눌하원을 주어 식읍으로 삼게하고 유유에게는 구사자를 추증했으며 유유의 아들 다우를 대사자로 삼았다. .[10]관구검의 침입으로 고구려는 크게 피해(被害)했다. 고구려의 주력군 대부분을 잃었고 도읍이었던 환도성이 불타고 폐허가 되었으며 다수한 인명이 피해했다. 248년, 동천왕이 서거하고 그 사람의 아들인 중천왕이 즉위한 일변, 고구려를 정벌하고 위로 귀환한 관구검은 진동도독으로 임명돼 근거지였던 요동 근처의 유주를 떠나서 양주로 내려갔고 오의 제갈각(諸葛恪)[11]의 침공을 막았다. 이 무렵 위는 사마씨의 전횡이 시작됐고 255년 관구검은 사마사(司馬師)의 전횡에 분노, 문흠(文欽)과 함께 기병했으나 문흠이 사마사에게 패하면서 관구검은 야반도주하는 길을 선택했고 자연히 그 사람이 거느린 말갈족을 비롯한 군세가 약화했다. 도주 중에 안풍진(安風津) 도위부(都尉部)의 백성인 장속(張屬)이 쏜 화살에 맞아 죽었다.259년 중천왕 12년 겨울 12월, 위(魏) 장수 위지해가 군사를 동원해 고구려에 침입했다. 중천왕은 정예 기병 5천 기를 선발해 위(魏)군과 양맥 골짜기에서 제이차양맥전투를 벌여 위군을 대파하고서 8천여 명을 참수했다.고구려에게는 처음 겪는 중화의 왕조와 벌인 전쟁이고 이 전쟁으로써 수많은 군사와 백성을 잃었으며, 도성이었던 환도성은 불타고 폐허가 됐다. 패기만만했던 동천왕은 패전 이후 크게 상심하다가 서거한 일변, 고구려 정벌에 성공한 위는 이후 벌어진 사마씨의 전횡에 따른 내홍이 지속으로 발생해 왕릉, 관구검, 제갈탄이 사마씨에 반기를 들어 내전이 벌어진 후 서진(西晉)이 등장해 삼국을 통일할 때까지 국외로 특별한 정복 활동이나 침공은 없었고 서진은 중원을 통일하나 서진 무제 사마염이 향락에 빠진 후 팔왕의 난을 거치면서 대내란이 벌어진 후 분열 시대인 오호십육국으로 이어진다.고구려에는 사상 처음 망국했을 만한 대위기를 맞은 후 중원은 분열과 북방 이민족의 대단위 침략으로 혼돈하는 시대로 접어 들자 고구려는 위기를 유효하게 극복했다.238년 고구려가 위와 협공해 요동의 공손씨를 멸망시킬 때까지 고구려와 위는 화친하고 협력했던 듯하나 242년 고구려는 요동의 서안평을 공격한다. 화친했는데도 고구려가 위의 서안평을 공격했다는 점에서 후대 사학자들은 요동의 공손씨의 협공 때 고구려의 참전을 조건으로 요동 지역의 분할을 위시해 어떤 대가를 요구한 후 이렇다할 약속이 이행되지 않자 고구려가 선제공격했다고 추측하며, 고구려의 사서는 전하지 않고 얼마 되지 않는 중국 측 사서에 의존하게 되어 실제이고 세부까지 포함한 전투 기록이 전하지 않으며 고구려와 위가 전투했던 비류수, 양맥의 정확한 위치도 사료로 남아 있지 않다. 현재 사학계는 비류수, 양맥 골짜기의 위치를 현재 중국 길림성 환인시, 즉 고구려의 환도성이었던 오녀산산성의 서측 혼강 부근으로 비정(比定)한다.